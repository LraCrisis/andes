<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
  <meta content="text/html; charset=ISO-8859-1"
 http-equiv="content-type">
  <title>Andes OLI Version</title>
</head>
<body>
<h1><span style="font-weight: bold;">Building the Andes OLI Course</span></h1>
<br>
This document describes how to build the OLI Andes-based physics course
content from the Andes source code tree. <br>
<h4>Content package version number<br>
</h4>
Formally, what you are building is called a<span
 style="font-style: italic;"> content package</span>.
The content package includes all resources needed for the course
content. This content package is deployed onto an OLI server. Once
deployed, instructors or developers with the appropriate access may
then create course sections using this content package.<br>
<br>
OLI content packages have a version identifier included within them.
For Fall 2007, for example, it was 1.8. This content package version
number functions within
OLI somewhat like
an edition number on a textbook: courses built on one version of the
content package may get patched as that version of the content package
is
updated, but such courses are never upgraded to use a different version
of the content package. Usually, an instructor creating a course will
only have
access to the latest version of the content package deployed on that
server when creating a new course. In special circumstances a course
creator might be offered a choice of&nbsp; different versions of the
content package, but in practice this only arises for developers.<br>
<br>
The content package version has normally been
incremented each semester to label a new semester's release, which
typically coincides with a new version of the Andes client program
which may not be able to read old problem files. But this is not
strictly necessary. In Spring 2008, no new version of the content
package was generated. Because there were no radical changes to Andes
or the problems, the 1.8 version was simply updated with a small number
of fixed problem files. That means existing courses built in the fall
on using 1.8 were
automatically patched with the fixed files when this update was
applied. <br>
<br>
However, we expect that Fall 08 will use a new version 1.9 of the
content package.<br>
<h2>Accessing OLI <br>
</h2>
You must obtain a CMU andrew account. The OLI folks must give your
account permission to access the OLI servers. <br>
<br>
OLI course development involves the following servers:<br>
<ul>
  <li>The CVS repository server: <span style="font-weight: bold;">oli-cvs.andrew.cmu.edu</span><br>
  </li>
  <li>The development server (ODIN):&nbsp; <span
 style="font-weight: bold;">odin.web.cmu.edu</span><br>
  </li>
  <li>The QA server: <span style="font-weight: bold;">oli-qa.andrew.cmu</span><br>
  </li>
  <li>The production server: <span style="font-weight: bold;">www.cmu.edu/oli/</span></li>
</ul>
The front page of ODIN links to some documentation on OLI development
processes, which should also be consulted. A course author can freely
build, deploy and update a private version of the content package on
the development server and then build test courses using that package.
Moving the course to QA or production is
done by OLI staff at the appropriate time.<br>
<br>
OLI requires all source for building a course to be stored in its own
CVS repository.&nbsp; The OLI-CVS host is actually the same as odin,
the development server. The bulk of the source to go into this
repository are OLI problem pages and related problem files which are
generated automatically from the Andes
source tree. Other portions like the course introduction page must be
created or modified by hand.<br>
<h2>Checking out from OLI-CVS</h2>
The CVS module containing the OLI physics course source is named
"intro-physics-1.0".&nbsp; To check out the main branch use commands
like the following:<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp; cd ANDESROOT/oli&nbsp;&nbsp;&nbsp; # optional:
change into oli subdirectory of an Andes source treee<br>
&nbsp;&nbsp;&nbsp;&nbsp; cvs -d
:ext:andersw@oli-cvs.andrew.cmu.edu:/oli/cvs/content/lrdc/intro_physics
co -d intro_physics-1.9 intro_physics-1.0 <br>
<br>
replacing the "andersw" with the appropriate user id. <br>
<br>
Because you can find yourself managing multiple versions of the content
package, I recommend using the -d option and replacing the 1.9&nbsp;
with the latest content package version number, so as to&nbsp; create a
directory named intro_physics-1.9. I do this within the "oli"
subdirectory of the Andes working directory to make use of scripts in
that&nbsp; directory.<br>
<br>
Note the "1.0" at&nbsp; the end of the CVS project name is meaningless,
and
is potentially misleading, since the 1.0 used here never changes as new
editions of the course are developed.&nbsp; The real
content package version number is set inside the sources (details
below).&nbsp; <br>
<h4>Checking out patch branches</h4>
After a version of the content package is deployed onto the production
server (normally at the start of a semester), the OLI folks will create
a branch in cvs to hold any patches to the content. If the content
package is numbered 1.9, then the patch branch will be named
v_1_8_patches. <br>
So, to check out the patch branch for working on mid-semester updates
you can do:<br>
<br>
cvs -d
:ext:andersw@oli-cvs.andrew.cmu.edu:/oli/cvs/content/lrdc/intro_physics
co -r v_1_9_patches -d intro_physics-v_1_9_patches intro_physics-1.0<br>
<h2>OLI Source structure</h2>
The OLI source for the course has two main subdirectories:<br>
&nbsp;&nbsp;&nbsp; content - holds the course content<br>
&nbsp;&nbsp;&nbsp; organizations - holds&nbsp; the&nbsp; files
specifying possible organizations of the course<br>
<br>
It also contains a "tools" directory&nbsp; which&nbsp; we do&nbsp; not
modify.<br>
<h4>The content tree</h4>
<h5>package.xml</h5>
The root of the content tree contains the file package.xml which
describes the content package. The most important thing in this is the
version identifier, which is specified as an attribute of the package
element as follows:<br>
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &lt;package id="intro_physics"
version="1.8"&gt;<br>
To create a new version of the content package, this version number
must be changed. This is usually done once for each semester containing
a significant new version, since this generally involves a new Andes
version with potentially new problem files. <br>
<br>
If Andes has not changed much but for a few bug fixes, it is not
necessary to increment the content package version number for a new
semester. However, then any changes or updates that are made to the
content will be applied to old courses without any special notice. This
is fine to fix bugs that don't require a new Andes client installation,
but problematic if the changes require a new client installation.<br>
<br>
In the past, the OLI maintainers have incremented the version number
for us, so you should check this has not already been done before
generating a new one. However, more recently we have been incrementing
it ourselves.<br>
<h5>File type subdirectories</h5>
Within the content tree, files are grouped by type into subdirectories
named for the MIME type of files they contain. <br>
&nbsp;&nbsp;&nbsp; x-oli-workbook_page&nbsp; -- OLI workbook pages<br>
&nbsp;&nbsp;&nbsp; x-pitt-lrdc-andes1-assignment -- xml problem
descriptor files (described below)<br>
&nbsp;&nbsp;&nbsp; webcontent -- any content files that can be served
without special handling by a web server: gifs, jpegs, wmvs, whatever.<br>
<br>
For andes-specific files, we use a subdirectory within a webcontent
folder:<br>
&nbsp;&nbsp;&nbsp; webcontent/andes -- andes-problem files. This
includes the prb files for the problems as well as gifs or jpegs used.<br>
<br>
The workbook pages are the source for the course pages in an
OLI-defined xml format which. The
exact specification via a dtd and a tutorial course can be found from
the front page of the development server. We use only a simple subset
of the features which should be self-explanatory.<br>
<br>
The x-pitt-lrdc-andes1-assignement files are small problem descriptor
files in an OLI-defined xml format. These are used by the OLI
andes-specific server side code to find the little bit of information
it needs about Andes problems. There must be one such file per problem.
An example of the contents is as follows:<br>
<br>
&lt;?xml version='1.0' encoding='UTF-8'?&gt;<br>
&lt;!DOCTYPE andes_assignment PUBLIC '-//Carnegie Mellon
University//DTD Andes Assignment 1.0b1//EN'
'http://oli.web.cmu.edu/dtd/pitt_lrdc_andes1_assignment_1_0b1.dtd'&gt;<br>
<br>
&lt;andes_assignment id="CM1"&gt;<br>
&nbsp;&nbsp;&nbsp; &lt;title&gt;Linear Momentum - CM1&lt;/title&gt;<br>
&nbsp;&nbsp;&nbsp;
&lt;path&gt;_u1_intro_physics/_m01_mechanics/webcontent/andes/&lt;/path&gt;<br>
&lt;/andes_assignment&gt;<br>
<br>
These are normally generated automatically.<br>
<h5>Unit and module structure</h5>
The content directory is structured into a subdirectory for one unit
which contains two module subdirectories within it. These parallel the
original unit and module structure of the course. These are named<br>
&nbsp; content<br>
&nbsp;&nbsp;&nbsp;&nbsp; _u1_intro_physics<br>
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _m01_mechanics<br>
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; _m02_em<br>
<br>
The key point is that the mechanics-related files have to go within the
_m01_mechanics subtree while the E&amp;M files have to go within the
_m02_em subtree. Both are contained in one big "unit" which is
essentially
the whole course.<br>
<br>
Note: This hierarchical structure with unit and module directories was
once required by the OLI system, but is not required any longer by the
latest versions of the OLI system. So this structure could in principle
be
simplified to include all problem files in one directory. But it
is a
nuisance to change directory structure once the CVS is set up. The
existing
aps2xml.pl script assumes this directory structure. <br>
<br>
The _u1_intro_physics unit directory contains the course introduction
page, and also an instructor-only information page. One might expect
supporting webcontent for these pages to be contained within the
_u1_intro_physics directory. However, for whatever reason,
supporting webcontent for these pages are contained ina webcontent
directory at the root of the course (within the content directory),
rather than within the _u1... subdirectory.<br>
<br>
The supporting webcontent for the course includes the andes installer.
It also includes videos linked on the course introduction page, images
used on these pages, and the fixgrades gradebook pruning utility
program for instructors. <br>
<h4>The organizations tree</h4>
This contains one subdirectory for each organization that an instructor
may select when building a course from this content package. An
organization file defines a kind of table of contents structure over
the course content, and may also customize the stakes or gating
requirements. We provide three:<br>
&nbsp;&nbsp;&nbsp; default -- the default, full course containing all
problems<br>
&nbsp;&nbsp;&nbsp; em -- the E&amp;M only course<br>
&nbsp;&nbsp;&nbsp; mechanics -- the mechanics only problems.<br>
<br>
The organizations are defined in an xml file according to an
OLI-specified format; again, the exact dtd is available from OLI. We
use OLI's <span style="font-style: italic;">simple</span> organization
format, in which it is only necessary to list the relevant modules (not
each individual problem).&nbsp; The simple organization files change
very rarely so are not automatically generated. The only change that
could be necessary would be to add a new problem set, in which case the
necessary changes should be obvious using the existing <br>
<br>
Organization files do also contain a reference to the version of the
content package they are associated with. This reference occurs in the
organization id wich is an attribute on the organization element:<br>
&lt;organization id="intro_physics-1.8_default" version="1.0"&gt;<br>
<br>
Notice this content id includes a version number within it. This part
of the id must match the version number in the content package. So, <span
 style="font-weight: bold;">any change to the content package version
number must also be applied to each organization.xml file </span>by
changing the version number within this id. For example, the
organization id may have to change from "intro_physics-1.8_default" to
"intro_physics-1.9_default". <br>
<br>
Defining the gating requirements defined for Sandy Katz's experiment
involved adding new custom organizations for each experimental
condition. These organizations required using the <span
 style="font-style: italic;">full</span> format organization files,
which requires more detail to be specified, but allows prerequisite
relationships to be defined for each problem. In addition, customized
version of the course pages also had to be generated and referenced by
these organizations. This is an advanced task which was only partly
automated and may never have to be repeated, so it is not described
further here.<br>
<br>
<h2>Building or updating the OLI course source</h2>
Building the OLI course source from the Andes source has two main
components:<br>
<ol>
  <li>&nbsp;building the OLI problem pages (including copying problem
and video files); and <br>
  </li>
  <li>building the andes client installer.<br>
  </li>
</ol>
Any other tasks like editing the introduction page or adding more pages
to the course, must be
done by hand. <br>
<h4>Building the OLI problem pages</h4>
The OLI problem pages are generated from a set of Andes problem set
files by the script aps2xml.pl in the Andes tools directory. Performing
this
process involves the following steps.<br>
<h5>Possible modifications to the script</h5>
The script maintains a list of problem sets that belong in the EM
module, putting all others within the mechanics module. If a new
problem set is added to EM, it must be added to this list in aps2xml.<br>
<h5>Exporting problem statements</h5>
The aps2xml script makes use of&nbsp; problem statement files exported
from the Lisp problem definitions. To export statement files from Lisp
into the place where the script expects to find them:<br>
&nbsp;&nbsp;&nbsp; 1. (first time only) In the Andes source tree root,
create a directory named "Statements"<br>
&nbsp;&nbsp;&nbsp; 2. Load the Andes sgg and problem definitions into
Lisp<br>
&nbsp;&nbsp;&nbsp; 3. In Lisp, type (write-stmts)<br>
<br>
This should be done before each run to make sure the exported statement
files are up to date. It will write one file per problem named
PROBLEMNAME.txt containing the text of the problem statement.<br>
<br>
[With a little work this step could be eliminated, but this is how it
works now.]<br>
<h5>Building the content pages</h5>
<h6>Copy the desired Problem Set (.aps) files</h6>
The Andes source tree usually contains more .aps files than are
actually used in a distribution. Copy only the aps files needed for a
distribution into the root of your version-specific OLI course content
tree. Once the course is deployed, these should be saved here rather
than updated, so future updates use the set of problems in effect at
the time the course was generated. (They could be added to the patch
branch, in fact).<br>
<br>
In the OLI source directory type a command of the form<br>
&nbsp;&nbsp;&nbsp; perl&nbsp; ../../aps2xml.pl *.aps &gt;
DATE-output.txt<br>
The output file name is irrelevant. Since this process may be done
several times, I recommend replacing DATE with some date indication,
e.g. Sep10, so that you can save a record of the results on each run.
The output is quite verbose and detailed. <br>
<br>
This should create the workbook pages containing problems and demo
videos. For example, for "Translational Kinematics.aps" it will create
a file called"translational_kinematics.xml" within the
x-oli-workbook-page subdirectory of the mechanics module. It copies all
files as needed into the correct directories. <br>
<h5>Add any new files to CVS</h5>
If any new files have been added, these must be explicitly added to the
OLI cvs repository. For example, if new problems have been added to the
set, there will be new prb files, new xml problem descriptor files, and
possibly new gif or jpeg files.<br>
<br>
You can find out if any new files were adding by searching for "adding"
within the script output:<br>
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp; grep adding DATE-output.txt<br>
<br>
If new files were added, one way to get them into CVS is just to go
into the relevant directories and just add<span
 style="font-style: italic;"> all</span> files of the appropriate type.
CVS will ignore files already present in its repository, so this is
safe, though it can generate lots of messages. For example:<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp; cd content/_u1_intro_physics/_m01_mechanics<br>
&nbsp;&nbsp;&nbsp;&nbsp; cvs add x-pitt-lrdc-andes-assignment./*.xml<br>
&nbsp;&nbsp;&nbsp;&nbsp; cvs add&nbsp; webcontent/andes/*.prb<br>
&nbsp;&nbsp;&nbsp;&nbsp; cvs add webcontent/andes/*.gif<br>
&nbsp;&nbsp;&nbsp;&nbsp; cvs add webcontent/andes/*.jpg<br>
&nbsp;&nbsp;&nbsp;&nbsp; cd ../_m02_em<br>
&nbsp;&nbsp;&nbsp;&nbsp; cvs add x-pitt-lrdc-andes-assignment./*.xml<br>
&nbsp;&nbsp;&nbsp;&nbsp; cvs add&nbsp; webcontent/andes/*.prb<br>
&nbsp;&nbsp;&nbsp;&nbsp; cvs add webcontent/andes/*.gif<br>
&nbsp;&nbsp;&nbsp;&nbsp; cvs add webcontent/andes/*.jpg<br>
&nbsp;&nbsp;&nbsp;&nbsp; cvs add x-oli-workbook-page/*.xml<br>
<br>
In addition, if a new problem set&nbsp; as added, these also
have to be added to CVS. These will not show up in the grep above. Add<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; cvs add x-oli-workbook-page/*.xml<br>
to the command lists above.<br>
<br>
If any hand generated content or video files are added, these also must
be added.<br>
<br>
Note there is no automated <span style="font-style: italic;">removal</span>
of obsolete problem files that have been removed from the course. This
must be done by hand. It is harmless to leave old files in the content
package, though they do take up space, so it is good to clean them up
now and again.<br>
<h4>Building the OLI Andes client installer</h4>
This file is named andes_installer.exe and goes in the root webcontent
directory. One can build the installer by using the MakeDist.sh script
in the Andes tools directory.<br>
From the Andes root directory type<br>
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp; /tools/MakeDist.sh -oli<br>
This should build an OLI version installer andes_installer.exe in the
current directory.<br>
<br>
Then copy the installer into the OLI version directory. For example, if
you are building intro_physics_1_9_patches, do:<br>
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp; cp andes_installer.exe
oli/intro_physics_1_9_patches/content/webcontent<br>
<br>
It can also be desirable to save the components that went into this
installer, so you can easily check the versions that were used at a
later date. You can do this by copying the zipped archive of the
installer files<br>
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp; cp andes_installer.zip
oli/intro_physics_1_9_patches<br>
<h4>Updating the Organizations</h4>
If any problem sets have been added or deleted, the relevant
organizations must also be updated. This happens rarely so has not been
automated. Change into each organization subdirectory and modify the
file organization.xml to add or delete the relevant module reference.
The format required should be self-explanatory from looking at the
module list.&nbsp; Within the organization file, a module looks like
this:<br>
<br>
&nbsp;&nbsp;&nbsp; &lt;module id="module_kinematics_graphs"&gt;<br>
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;
&lt;title&gt;Kinematics Graphs&lt;/title&gt;<br>
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &lt;item
id="item_kinematics_graphs"&gt;<br>
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp; &lt;resourceref idref="kinematics_graphs"/&gt;<br>
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &lt;/item&gt;<br>
&nbsp;&nbsp;&nbsp; &lt;/module&gt;<br>
<br>
The item id and module id are local to this file and can in fact take
any format. However, the idref used in the resourceref must match the
id used on the learning page id. Our convention is to use the title of
the module in lower case with spaces changed to underscores.<br>
<h4>Update CVS</h4>
After all updates are ready, of course you must commit all changes into
OLI's CVS. Change to the root of the OLI course source tree and type<br>
&nbsp;&nbsp;&nbsp; cvs commit<br>
<h2>Building the OLI&nbsp; content package</h2>
You should build and deploy the content on the OLI development server. <br>
<br>
[The following is copied from documentation available on the ODIN start
page. Consult that site for the very latest version] <br>
<br>
1. Connect to the server.<br>
From your local computer, start Cygwin. Use SSH to connect to the
server.<br>
&nbsp;&nbsp;&nbsp; $ ssh [user ID]@[server hostname]<br>
Example:<br>
&nbsp;&nbsp;&nbsp; $ ssh andersw@odin.web.cmu.edu<br>
Note: All subsequent commands will be run on/from the OLI development
server and not your local computer. Remember to logout when finished.<br>
<br>
AW: To be sure of having enough disk space, it may be desirable to do
the following within the "private" space alloted to developers by OLI,
rather than your home directory.<br>
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp; cd /oli/private/andersw<br>
I have put this command into my .login file.<br>
<br>
2. Setup the project directory, if necessary. [one-time setup step]<br>
If this is the first time you are deploying your content, checkout a
local copy of your project from CVS. Otherwise, proceed to step 3. You
only need to setup your project directory once.<br>
&nbsp;&nbsp;&nbsp; $ cvs &#8211;d [server hostname]:/home/[project name]/cvs
co [project name]<br>
Example:<br>
&nbsp;&nbsp;&nbsp; $ cvs &#8211;d oli-community.andrew.cmu.edu:/home/cmu/cvs
co intro_physics-1.0 <br>
<br>
3. Change directory to project folder.<br>
The deploy and update commands must be run from the root of the project
structure.<br>
&nbsp;&nbsp;&nbsp; $ cd [project name]<br>
<br>
4. Copy configuration settings from sample, if necessary. [one-time
setup step]<br>
If this is the first time you are deploying your content, run the
command below. Otherwise proceed to step 5. You only need to run this
command once.<br>
&nbsp;&nbsp;&nbsp; $ cp log4j.properties.sample log4j.properties<br>
<br>
5. Update the course project from CVS.<br>
In order for your changes to be loaded into the OLI delivery
environment, you must first retrieve those changes from CVS.<br>
&nbsp;&nbsp;&nbsp; $ cvs update &#8211;Pd<br>
<br>
6. Build the content package using Ant.<br>
&nbsp;&nbsp;&nbsp; $ ant<br>
<br>
7. Deploy or update content as is required.<br>
<br>
&nbsp;&nbsp; To deploy the content, run the deploy script. The deploy
command completely removes and reloads your content, organizations, and
course syllabi. The deploy command is used to initially load your
content and subsequently when the structure (i.e., organization) has
changed.<br>
&nbsp;&nbsp;&nbsp; $ ./tools/oli/deploy.sh<br>
<br>
To update the content package, run the update script. The update
command does not update any organizations or change the structure of
existing course syllabi. It updates the files contained in the content
package.<br>
&nbsp;&nbsp;&nbsp; $ ./tools/oli/updatepkg.sh<br>
<br>
8. Create a course, if necessary. [one-time setup step]<br>
If this is the first time you are deploying your content, create a new
course using the course builder. In the future, when you deploy or
update your course will be automatically updated to reflect your
changes. To create your course, follow the instructions in the course
builder manual.<br>
<br>
AW: This process builds a private version of the content package which
you own and can test with. The content package name will be qualified
with the creator's user id. So the resulting content package will be
called, for example, intro_physics-andersw-1.9, and this may be seen in
some OLI prompts. When it is deployed on production, the owner
qualifier will be absent.<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<h1><span style="font-weight: bold;"></span></h1>
</body>
</html>
