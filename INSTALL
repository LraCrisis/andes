
      Instructions for Installing Andes

Andes works with several varieties of lisp, but
has been used most extensively with sbcl and Allegro lisp.
The webserver functionality has only been developed for sbcl.
A sample ~/.sbclrc file has been included as sbclrc-sample.
Andes uses asdf as its package manager; both the sbcl and 
Allegro lisp distributions include asdf.

Compile the solver library and executable:
  cd Algebra/src/; make solver-program

For the system to work, a library of problem definitions 
must be included.  The original Andes problem definitions
are under copyright and not publicly available.  For access,
send your ssh public key to help@andestutor.org  The git command
to download this library is (from the Andes root directory):
   git clone ssh://git@andestutor.org/home/git/Andes-problems.git/ problems
Likewise, at least for Andes2, one can use the solutions repository:
   git clone ssh://git@andestutor.org/home/git/Andes-solutions.git/ solutions

ImageMagick http://www.imagemagick.org is used to dimension graphics
files.  This is included in standard linux distributions.

=============== Web Server =================================

# Install the hunchentoot web server ttp://www.weitz.de/hunchentoot/
# using asdf-install.  asdf-install broken in that it will try to load
# packages we said we didn't need, like cl+ssl and its dependent cffi.
# Check that the permissions in /usr/local/lib/sbcl/site* are OK
  (require 'asdf-install)
  (push :hunchentoot-no-ssl *features*) ;we have apache to do this
  (asdf-install:install 'hunchentoot)
  (asdf-install:install 'cl-json)

# Next, configure Apache as reverse proxy server, with json-rpc 
# error messages.  In httpd.conf, add:
  <Location /help>
    ProxyPath http://localhost:8080/help
    ReverseProxyPath http://localhost:8080/help
    ErrorDocument 502 "{\"jsonrpc\": \"2.0\", \"error\": {\"code\": 502, \"message\": \"Andes help server:  proxy error\"}, \"id\": null}"  
    ErrorDocument 503 "{\"jsonrpc\": \"2.0\", \"error\": {\"code\": 503, \"message\": \"Andes help server:  Service Temporarily Unavailable\"}, \"id\": null}"  
  </Location>
# For older versions of Apache, use something like:
  <IfModule mod_proxy.c>
    ProxyRequests Off
    ProxyPass /help http://localhost:8080/help
    ProxyPassReverse /help htttp://localhost:8080/help
  </IfModule>
# add links to web-UI and images in /var/www/html
# Then restart:
  /sbin/service httpd reload

# To run server in lisp:
  (rhelp)
  (start-help)
# There is a bug, which causes this to hang, see
# http://common-lisp.net/pipermail/tbnl-devel/2009-February/004608.html
# http://common-lisp.net/pipermail/tbnl-devel/2009-February/004589.html
  (stop-help)
